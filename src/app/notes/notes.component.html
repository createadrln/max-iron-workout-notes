<!-- ToDo make sure everything works or there is a fallback when not connected to firebase -->
<!-- ToDo add Alexa integration -->
<!-- ToDo restore and make PWA -->
<!-- ToDo look at UI for buttons (sidebar nav?) -->
<!-- ToDo add edit selected weekly workouts -->

<div class="workout-form-container border shadow bg-white mb-0 mb-sm-5" [@formSlideIn]="formWorkoutNoteVisibilityState">
    <div class="p-3">
        <div class="modal-title mb-2 pr-5">
            <mat-icon class="close-button" (click)="toggleWorkoutNoteFormState()">cancel</mat-icon>
            <h5 class="text-uppercase">Add a new workout</h5>
        </div>
        <div class="modal-content">
            <div class="modal-body">
                <app-workout-note-form></app-workout-note-form>
            </div>
        </div>
    </div>
</div>

<div class="workout-form-container workout-notebook-form border shadow bg-white mb-0 mb-sm-5" [@formSlideIn]="formWorkoutNotebookVisibilityState">
    <div class="p-3">
        <div class="modal-title mb-2 pr-5">
            <mat-icon class="close-button" (click)="toggleWorkoutNotebookFormState()">cancel</mat-icon>
            <h5 class="text-uppercase">Add workout notebook</h5>
        </div>
        <div class="modal-content">
            <div class="modal-body">
                <app-workout-notebook-form></app-workout-notebook-form>
            </div>
        </div>
    </div>
</div>
<div *ngIf="formWorkoutNotebookVisibilityState == 'active'" class="d-sm-none modal-overlay" (click)="toggleWorkoutNotebookFormState()"></div>
<div *ngIf="formWorkoutNoteVisibilityState == 'active'" class="d-sm-none modal-overlay" (click)="toggleWorkoutNoteFormState()"></div>


<section class="px-3 px-sm-5 m-sm-5">
    <div class="row">
        <div class="col-sm-6">
            <h3 class="text-uppercase">{{ upcomingWeekTitle }}</h3>
            <h4>Workout Description: {{ upcomingWeekDescription }}</h4>
        </div>
        <div class="col-sm-6">
            <select class="form-control mb-3 my-sm-0"
                    (selectionChange)="selectNewWorkoutCollection($event)">
                <option>Change workout plan</option>
                <option *ngFor="let workoutCollection of weeklyWorkoutCollections | async"
                        [value]="workoutCollection.key">{{ workoutCollection.title }} - {{ workoutCollection.description }}
                </option>
            </select>
            <!--<div class="workout-note-actions mx-3 px-3 px-sm-5 pb-2 pb-sm-5">-->
            <div class="workout-note-actions mt-3 text-right">
                <button class="btn btn-primary mr-sm-2 mb-2 mb-sm-0"
                        (click)="toggleWorkoutNoteFormState()">Add New Workout
                </button>
                <button class="btn btn-primary mr-sm-2 mb-2 mb-sm-0"
                        (click)="toggleWorkoutNotebookFormState()">Add Workout Notebook
                </button>
            </div>
        </div>
    </div>
</section>

<div class="px-3 px-sm-5 mb-3 m-sm-5" *ngFor="let note of weeklyWorkouts | async | reverse; let n = index">
    <section>
        <div class="bg-dark text-white rounded-top rounded-left rounded-right p-3">
            <header>
                <div class="row">
                    <div class="col-md-7">
                        <span class="bold text-accent">Workout {{ n + 1 }}</span>
                        <h5>{{ note.title }}</h5>
                        <p>{{ note.description }}</p>
                    </div>
                    <!-- ToDo make exercise control page with delete notes action -->
                    <!--<div class="col-md-5 text-left">-->
                    <!--<button class="btn btn-danger" (click)="deleteNote(note)">Delete Note</button>-->
                    <!--</div>-->
                </div>
            </header>
        </div>
    </section>

    <section>
        <div class="d-block rounded-bottom rounded-left rounded-right w-100">
            <div *ngFor="let exercise of note.exercises; let i = index" class="border-bottom bg-white p-3">
                <div class="row">
                    <div class="align-middle col-12">
                        <!-- ToDo edit exercises -->
                        <mat-icon class="alert-danger float-right" (click)="editWorkoutNoteRow(exercise.$key, i)">edit</mat-icon>
                        <!--<button class="btn btn-sm btn-danger float-right">Edit</button>-->
                        <!-- ToDo add action for checkbox completed exercise -->
                        <!--<span>-->
                            <!--<mat-icon class="float-right">check_box</mat-icon>-->
                            <!--<mat-icon class="float-right">check_box_outline_blank</mat-icon>-->
                        <!--</span>-->
                        Exercise {{ i + 1 }}<br>
                        <span class="text-primary font-weight-bold">{{ exercise.title }}</span>
                    </div>
                </div>
                <div class="row">
                    <div class="align-middle col-4">
                        <div class="border-bottom mt-1 mb-2 pb-1">Sets</div>
                        {{ exercise.sets }}
                    </div>
                    <div class="align-middle col-4">
                        <div class="border-bottom mt-1 mb-2 pb-1">Reps</div>
                        {{ exercise.reps }}
                    </div>
                    <div class="align-middle col-4">
                        <div class="border-bottom mt-1 mb-2 pb-1">Weight</div>
                        {{ exercise.weight }}
                    </div>
                </div>
                <!--<td *ngFor="let col of exercise.cols; let j = index" class="align-middle">-->
                <!--&lt;!&ndash; Main exercise info and input &ndash;&gt;-->
                <!--<span *ngIf="editRowValues != [i]">{{ col }}</span><br>-->
                <!-- ToDo edit workout cells -->
                <!-- ToDo convert string to number and count -->
                <!--<input *ngIf="editRowValues == [i]" class="form-control" value="{{ col }}" #rowCol-->
                <!--(blur)="rowCols[j].$value = rowCol.value"-->
                <!--(keyup.enter)="rowCols[j].$value = rowCol.value">-->
                <!--</td>-->
                <!--<td class="text-right">-->
                <!--<div>-->

                <!-- todo make sure only one note row is edited -->
                <!--&lt;!&ndash; Main exercise actions &ndash;&gt;-->
                <!--<div *ngIf="editRowValues != [i]" id="edit-row-button" class="btn btn-info btn-sm"-->
                <!--(click)="editRow(note.$key, i)">Edit <span-->
                <!--class="glyphicon glyphicon-pencil"></span></div>-->
                <!--<div *ngIf="editRowValues == [i]" id="save-edit-row-button" class="btn btn-info"-->
                <!--(click)="saveRow(note.$key, i)">Save <span class="glyphicon glyphicon-ok"></span>-->
                <!--</div>-->
                <!--<div *ngIf="editRowValues == [i]" class="btn btn-default"-->
                <!--(click)="editRowValues = null">Cancel <span-->
                <!--class="glyphicon glyphicon-refresh"></span></div>-->
                <!--<div id="delete-row-button" class="btn btn-danger btn-sm"-->
                <!--(click)="deleteRow(note.$key, exercise, i)">Del <span-->
                <!--class="glyphicon glyphicon-trash"></span></div>-->

                <!--&lt;!&ndash; Exercise extra set info actions &ndash;&gt;-->
                <!--<div *ngIf="addChildRowValues != [i]" class="btn btn-info btn-sm"-->
                <!--(click)="addChildRow(note.$key, i)">Add Set <span-->
                <!--class="glyphicon glyphicon-plus"></span></div>-->
                <!--<div *ngIf="addChildRowValues == [i]" class="btn btn-success"-->
                <!--(click)="saveChildRow(note.$key, i, exercise.child_cols.length)">+ Save Set-->
                <!--</div>-->

                <!--</div>-->
                <!--<div>-->
                <!--<span *ngIf="addChildRowValues == [i]" class="btn btn-link"-->
                <!--(click)="addChildRowValues = null">Cancel New Set</span>-->
                <!--</div>-->
                <!--</td>-->
            </div>

            <!--<tfoot>-->
            <!--<tr>-->
            <!--<td class="align-middle">-->
            <!--<input class="form-control" type="text" id="row-title" required #rowTitle name="row-title"-->
            <!--placeholder="Title">-->
            <!--</td>-->
            <!--<td class="align-middle">-->
            <!--<input class="form-control" type="text" id="row-reps" required #rowReps name="row-reps"-->
            <!--placeholder="Reps">-->
            <!--</td>-->
            <!--<td class="align-middle">-->
            <!--<input class="form-control" type="text" id="row-sets" required #rowSets name="row-sets"-->
            <!--placeholder="Sets">-->
            <!--</td>-->
            <!--<td class="align-middle">-->
            <!--<input class="form-control" type="text" id="row-weight" required #rowWeight name="row-weight"-->
            <!--placeholder="Weight">-->
            <!--</td>-->
            <!-- Iterating through any columns -->
            <!--<td *ngFor="let col of note.exercises[0].cols; let j = index" class="align-middle">-->
            <!--<input class="form-control" placeholder="Row Col-{{ j }}" name="rowCol_{{ j }}" #rowCol-->
            <!--(blur)="rowCols[j] = rowCol.value" (keyup.enter)="rowCols[j] = rowCol.value">-->
            <!--</td>-->
            <!--<td>&nbsp;</td>-->
            <!--</tr>-->
            <!--</tfoot>-->

        </div>
    </section>
</div>
