<!-- ToDo Add Search Filter -->
<!-- ToDo Add Set To Current Workout -->

<header class="workout-notebooks__header">
    <div class="mx-3 mx-sm-5 my-4 my-sm-0 mt-sm-5 mb-sm-3 pb-3 border-bottom border-dark clearfix">
        <h1 class="h5 float-sm-left">My Workout Notebooks</h1>
        <div class="btn btn-link text-success float-sm-right p-0" (click)="openNewWorkoutModal(new_workout_modal)">
            <mat-icon class="align-middle mr-1">description</mat-icon>
            <span class="align-middle">Add New Notebook</span>
        </div>
    </div>
</header>

<section>
    <div class="workout-notebooks px-1 px-sm-5 mb-3 mb-sm-5">
        <div class="workout-notebooks__search col-sm-3 mb-3">
            <input type="text" class="form-control" placeholder="Search Workout Notebooks">
        </div>
        <div *ngFor="let notebook of workoutNotebooks | async; let i = index"
             class="workout-notebooks-row row p-4">
            <div class="col-12 col-sm-9">
                <div class="d-inline-block w-75 align-top">
                    <h3 class="h5">{{ notebook.title }}</h3>
                    <p class="m-0">
                        <em *ngFor="let tag of notebook.tags" class="mr-2">{{ tag.display }}</em>
                    </p>
                    <div class="form-group form-check form-checkbox mt-4">
                        <label class="form-check-label" for="set-current-workout">
                            Set as current workout
                            <input class="form-check-input" type="checkbox" id="set-current-workout">
                            <span class="form-checkmark"></span>
                        </label>
                    </div>
                </div>
                <div ngbDropdown class="d-inline-block w-25 align-top">
                    <button class="btn btn-link p-0 float-right" id="workoutOptions[n]" ngbDropdownToggle>
                        <mat-icon class="mat-18 text-dark">settings</mat-icon>
                    </button>
                    <div ngbDropdownMenu aria-labelledby="workoutOptions[n]" class="text-center">
                        <!-- ToDo allow control to change order -->
                        <!-- ToDo make edit note fields -->
                        <button class="dropdown-item px-0" (click)="editNote(note.key)">
                            Edit Note
                        </button>
                        <button class="dropdown-item px-0" (click)="updateNoteOrder(note.key)">
                            Change Order
                        </button>
                    </div>
                </div>
                <div class="mt-3">
                    <div *ngFor="let workout of notebook.workouts">
                        <ul *ngFor="let note of notes | async | key:workout.selected" class="list-group">
                            <li class="list-group-item">
                                <div class="clearfix py-1">
                                    <span class="float-sm-left"><strong>{{ note.title }}</strong></span>
                                    <mat-icon [hidden]="hideWorkoutExercises[note.key]" class="float-right"
                                              (click)="hideWorkoutExercises[note.key] = !hideWorkoutExercises[note.key]">
                                        arrow_drop_down_circle
                                    </mat-icon>
                                    <mat-icon [hidden]="!hideWorkoutExercises[note.key]" class="float-right"
                                              (click)="hideWorkoutExercises[note.key] = !hideWorkoutExercises[note.key]">
                                        cancel
                                    </mat-icon>
                                    <!-- ToDo Add removeWorkoutFromNotebook function -->
                                    <!--<span *ngIf="notebook.workouts.length > 1"-->
                                    <!--class="btn btn-link text-secondary p-0 float-sm-right"-->
                                    <!--(click)="removeWorkoutFromNotebook(notebook.key, note.key, i)">-->
                                    <!--<mat-icon class="text-secondary align-middle mr-1">remove_circle</mat-icon>-->
                                    <!--<span>[ Remove from notebook ]</span>-->
                                    <!--</span>-->
                                </div>
                                <div [hidden]="!hideWorkoutExercises[note.key]">
                                    <ul *ngFor="let exercise of note.exercises" class="list-group list-group-flush">
                                        <li class="list-group-item border-bottom-0">
                                            {{ exercise.title }}: Reps: {{ exercise.reps }} | Sets: {{ exercise.sets }} |
                                            {{ exercise.weight }}
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- ToDo popup alert to confirm save or delete -->
            <!--<ngb-alert *ngIf="deleteWorkoutAlert[i] === 'active'" [dismissible]="false">-->
                <!--<strong>Warning!</strong> You are about to delete a notebook.-->
                <!--<span class="btn btn-secondary ml-2" (click)="deleteNotebook(notebook.key)">Proceed</span>-->
            <!--</ngb-alert>-->
            <div class="col-12 mt-4">
                <button class="btn btn-success w-100 mb-2" (click)="toggleSaveWorkoutAlert(i)">Save Notebook</button>
                <button class="btn btn-danger w-100" (click)="toggleDeleteWorkoutAlert(i)">Delete Notebook</button>
            </div>
        </div>
    </div>
</section>

<!-- New Workout Form -->
<ng-template #new_workout_modal let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Add New Workout</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <app-workout-note-form></app-workout-note-form>
</ng-template>
